use hiveDB;

--create external table stored as textfile
DROP TABLE IF EXISTS flight_delay;

create external table if not exists flight_delay(ID INT, YEAR INT, MONTH INT, DAY INT, DAY_OF_WEE INT, AIRLINE VARCHAR(10),
FLIGHT_NUMBER INT, TAIL_NUMBER VARCHAR(20),
ORIGIN_AIRPORT VARCHAR(20), DESTINATION_AIRPORT VARCHAR(20), SCHEDULED_DEPARTURE INT, DEPARTURE_TIME INT,
DEPARTURE_DELAY INT, TAXI_OUT INT, WHEELS_OFF INT, SCHEDULED_TIME INT,
ELAPSED_TIME INT, AIR_TIME INT, DISTANCE INT, WHEELS_ON INT, TAXI_IN INT, SCHEDULED_ARRIVAL INT, ARRIVAL_TIME INT, ARRIVAL_DELAY INT, DIVERTED INT,
CANCELLED INT, CANCELLATION_REASON INT, AIR_SYSTEM_DELAY INT, SECURITY_DELAY INT, AIRLINE_DELAY INT,
LATE_AIRCRAFT_DELAY INT, WEATHER_DELAY INT)

ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n'
STORED AS TEXTFILE
LOCATION '/hive/Assignment5';

--2.display first 10 rows of records
select * from flight_delay limit 10;

--create external table with parquet file format
DROP TABLE IF EXISTS parquet_flight_delay;

create external table if not exists parquet_flight_delay(ID INT, YEAR INT, MONTH INT, DAY INT, DAY_OF_WEE INT, AIRLINE VARCHAR(10),
FLIGHT_NUMBER INT, TAIL_NUMBER VARCHAR(20),
ORIGIN_AIRPORT VARCHAR(20), DESTINATION_AIRPORT VARCHAR(20), SCHEDULED_DEPARTURE INT, DEPARTURE_TIME INT,
DEPARTURE_DELAY INT, TAXI_OUT INT, WHEELS_OFF INT, SCHEDULED_TIME INT,
ELAPSED_TIME INT, AIR_TIME INT, DISTANCE INT, WHEELS_ON INT, TAXI_IN INT, SCHEDULED_ARRIVAL INT, ARRIVAL_TIME INT, ARRIVAL_DELAY INT, DIVERTED INT,
CANCELLED INT, CANCELLATION_REASON INT, AIR_SYSTEM_DELAY INT, SECURITY_DELAY INT, AIRLINE_DELAY INT,
LATE_AIRCRAFT_DELAY INT, WEATHER_DELAY INT)

ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n'
STORED AS parquetfile;

insert into table parquet_flight_delay
select * from flight_delay;

--2.display first 10 rows of records
select * from parquet_flight_delay limit 10;








